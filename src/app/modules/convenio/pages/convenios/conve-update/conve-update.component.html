<div class="container">
  <div class="row p-3 justify-content-md-center">
    <div class="col-md-8">
      <div class="card shadow p-3 mb-5 rounded">
        <div class="card-header">
          <h3 class="card-title">Editar convenio: {{ datosConvenio.nombre }}</h3>

        </div>
        <!-- /.card-header -->
        <div class="card-body">
          <div class="row d-flex justify-content-center">
            <div class="col-md-10">
              <form (ngSubmit)="editarConvenio(editarForm.value)" [formGroup]="editarForm">
                <div class="input-group mb-1">
                  <span class="input-group-text izq" id="convenio"><b> Convenio *</b></span>
                  <select id="convenio" formControlName="convenio" class="form-select">
                    <option value="Intergubernativo" [selected]="datosConvenio.convenio === 'Intergubernativo'">
                      Intergubernativo
                    </option>
                    <option value="Interinstitucional" [selected]="datosConvenio.convenio === 'Interinstitucional'">
                      Interinstitucional</option>
                    <option value="Otra" [selected]="datosConvenio.convenio === 'Otra'">Otra
                    </option>
                  </select>
                </div>
                <div class="mb-1">
                  <label for="codigo" class="form-label">Número - Código</label>
                  <input type="text" class="form-control" id="codigo" formControlName="codigo">
                </div>
                <div class="mb-1">
                  <label for="nombre" class="form-label">Nombre del convenio *</label>
                  <input type="text" class="form-control" id="nombre" formControlName="nombre">
                  <div class="form-text" *ngIf="form['nombre'].touched && form['nombre'].invalid">
                    <div *ngIf="form['nombre'].errors && form['nombre'].errors['required']">* El
                      nombre del convenio
                      es requerido.</div>
                    <div *ngIf="form['nombre'].errors && form['nombre'].errors['minlength']">*
                      Objeto no puede tener menos de 3 caracteres.</div>
                  </div>
                </div>
                <div class="mb-1">
                  <label for="objeto" class="form-label">Objeto del convenio</label>
                  <input type="text" class="form-control" id="objeto" formControlName="objeto">
                </div>


                <div class="mb-1">
                  <label for="firma" class="form-label">Fecha de Firma *</label>
                  <input type="date" class="form-control" id="firma" formControlName="firma">
                  <div class="form-text" *ngIf="form['firma'].touched && form['firma'].invalid">
                    <div *ngIf="form['firma'].errors && form['firma'].errors['required']">* firma
                      es Requerido.</div>
                  </div>
                </div>
                <div class="mb-1">
                  <label for="plazo" class="form-label">Plazo (días) *</label>
                  <input type="number" class="form-control" id="plazo" formControlName="plazo">
                </div>
                <div class="mb-1">
                  <label for="fechafin" class="form-label">Fecha de Finalización</label>
                  <input type="date" class="form-control" id="fechafin" formControlName="fechafin">
                </div>

                <td>
                  <label for="financiamiento" class="form-label pr-4">Con Financiamiento</label>
                  <input class="form-check-input pointer" type="checkbox" role="switch" id="flexSwitchCheckDefault"
                    formControlName="financiamiento" title="Sin Fianciamieto/Con Financiamiento" />
                </td>
                <td>
                  <label for="conclusion" class="form-label pr-4 pl-4">Hasta la Conclusión de
                    Proyecto</label>
                  <input class="form-check-input pointer" type="checkbox" role="switch" id="flexSwitchCheckDefault"
                    formControlName="conclusion" title="Hasta la Conclusión de Proyecto" />
                </td>


                <div class="mt-3 d-flex justify-content-around">
                  <button (click)="cancel()" type="reset" class="btn btn-danger">Cancelar</button>
                  <button [disabled]="editarForm.invalid" type="submit" class="btn btn-primary">Registrar</button>
                </div>

              </form>

              <div class="alert alert-info mt-2" role="alert">
                <p *ngFor="let enti of datosConvenio.financiadoras">
                  <b> Entidad {{ enti.tipo }}:</b> {{ enti.entidad.denominacion }} <b>Monto:</b> {{
                  enti.monto }}
                  <!-- Button trigger modal -->
                  <button type="button" class="btn btn-primary btn-sm ml-3" (click)="editMonto(enti._id, enti.monto)"
                    data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                    <i class="fas fa-edit"></i>
                  </button>
                  <br>
                </p>
              </div>

              <div class="my-5">
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdropp">
                  Añadir Entidad
                </button>
                <!--  {{ convenioForm.value | json }} -->
              </div>



              <!-- Modal -->
              <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false"
                tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h1 class="modal-title fs-5" id="staticBackdropLabel">Modal title</h1>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <form (ngSubmit)="editFinan(editarMonto.value)" [formGroup]="editarMonto">
                        <div class="mb-1">
                          <label for="monto" class="form-label">Monto:</label>
                          <input type="text" class="form-control" id="monto" formControlName="monto">
                        </div>
                        <!-- {{ editarFinan.value | json }} -->
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                          <button type="submit" class="btn btn-primary" data-bs-dismiss="modal">Editar</button>
                        </div>
                      </form>
                    </div>

                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="staticBackdropp" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
          aria-labelledby="staticBackdropLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="staticBackdropLabel">
                  Registrar Entidades
                </h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <form (ngSubmit)="crearFinan(editarFinan.value)" [formGroup]="editarFinan">
                  <div class="mb-1">
                    <label for="entidad" class="form-label col-auto">Entidad *</label>
                    <!-- Para Mandar id // optionValueField="_id" -->
                    <ngx-select [allowClear]="true" [items]="entidadesData" optionTextField="denominacion"
                      optionValueField="_id" placeholder="Seleccione una Entidad" formControlName="entidad">
                    </ngx-select>
                  </div>
                  <div class="mb-1">
                    <label for="monto" class="form-label col-md-auto">Monto *</label>
                    <input class="form-control" type="number" formControlName="monto" />
                    <!-- <input class="form-control" type="text" name="currency-field"
                                                            id="currency-field" value="" data-type="currency"
                                                            placeholder="$1,000,000.00" formControlName="monto"> -->
                  </div>
                  <div class="m-1">
                    <label for="monto" class="form-label col-md-auto">Tipo de Entidad *</label>
                    <fieldset class="row mb-3">
                      <!-- <legend class="col-form-label col-sm-2 pt-0">Tipo de Entidad</legend> -->
                      <div class="col-sm-10">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="tipo" id="gridRadios1"
                            formControlName="tipo" value="Ejecutora" checked />
                          <label class="form-check-label" for="gridRadios1">
                            Ejecutora
                          </label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="tipo" id="gridRadios2"
                            formControlName="tipo" value="Financiadora" />
                          <label class="form-check-label" for="gridRadios2">
                            Financiadora
                          </label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="tipo" id="gridRadios3"
                            formControlName="tipo" value="Mixta" />
                          <label class="form-check-label" for="gridRadios3">
                            Mixta
                          </label>
                        </div>
                      </div>
                    </fieldset>
                  </div>

                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                      Cerrar
                    </button>
                    <button type="submit" class="btn btn-primary" data-bs-dismiss="modal">
                      Registrar
                    </button>
                  </div>
                  <!--  {{ editarFinan.value | json }} -->
                </form>
              </div>
            </div>
          </div>
        </div>
        <!-- /.card-body -->
      </div>
      <!-- /.card -->
    </div>
  </div>
</div>